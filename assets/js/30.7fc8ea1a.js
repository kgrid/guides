(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{307:function(t,e,s){"use strict";s.r(e);var a=s(14),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"ko-calling-other-kos"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ko-calling-other-kos"}},[t._v("#")]),t._v(" KO calling other KOs")]),t._v(" "),e("p",[t._v("An executive Knowledge Object can call the functions from other knowledge Objects, orchestrating the data flow and process among these KOs.")]),t._v(" "),e("p",[t._v("In this tutorial, we are demonstrating the concept of the executive object. The example KO is for the V8 script engine, which one of the engines included by default in the reference implementation of the KGrid Activator.")]),t._v(" "),e("p",[t._v("To do so, you will need to use V8 context to retrieve the executor from the dependent KOs.")]),t._v(" "),e("h2",{attrs:{id:"context-of-v8"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#context-of-v8"}},[t._v("#")]),t._v(" Context of V8")]),t._v(" "),e("p",[t._v("The V8 script engine has a "),e("code",[t._v("context")]),t._v(" object where the objects and functions are stored. After the KOs are activated, each KO executor can be accessed in the context.")]),t._v(" "),e("h2",{attrs:{id:"get-the-executor"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#get-the-executor"}},[t._v("#")]),t._v(" Get the executor")]),t._v(" "),e("p",[t._v("In the script of the executive object, the following code will retrieve the executor for the KO of "),e("code",[t._v("ark:/js/simple/")]),t._v(". You will replace this ARK id with the Ark ID of the KO you'd like to call.")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" executor "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getExecutor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/simple/1.0/welcome"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Note that 1.0 refers to the api version in the service specification of the object being called.")])]),t._v(" "),e("h2",{attrs:{id:"pass-in-the-inputs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pass-in-the-inputs"}},[t._v("#")]),t._v(" Pass in the inputs")]),t._v(" "),e("p",[t._v("The executive object should know the input schema for the KO it is calling. It will construct the inputs for each child KO and pass to the respective KO's executor as argument.\nExecute also takes the MIME type of the input as a second argument.")]),t._v(" "),e("p",[t._v("As shown below, "),e("code",[t._v("ted")]),t._v(" is the input for "),e("code",[t._v("executor")]),t._v(' with the type "text/plain"')]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" executor"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ted"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/plain"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Due to a limitation of the Graal V8 engine it is not possible to pass a javascript object between KOs.\nThus if you wish to pass an object stringify the object first and use the type "),e("code",[t._v("application/json")]),t._v(" as the MIME type. The javascript engine will parse the inputs back into an object before passing it into the function being called.")]),t._v(" "),e("h2",{attrs:{id:"work-with-the-result"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#work-with-the-result"}},[t._v("#")]),t._v(" Work with the result")]),t._v(" "),e("p",[t._v("As shown in the above code, the result returned from the child KOs will be aggregated by the executive object. The results can then be used in the consecutive codes in the executive object. The executive object will eventually return its own response to the service request.")]),t._v(" "),e("h2",{attrs:{id:"more-examples"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#more-examples"}},[t._v("#")]),t._v(" More examples")]),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"https://github.com/kgrid-objects/example-collection",target:"_blank",rel:"noopener noreferrer"}},[t._v("example collection"),e("OutboundLink")],1),t._v(" contains examples of an executive object for the javascript V8 engine, the node engine and the python engine.")]),t._v(" "),e("h2",{attrs:{id:"node-js-engine-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-js-engine-example"}},[t._v("#")]),t._v(" Node.js engine example:")]),t._v(" "),e("p",[t._v("In each engine the syntax for getting another object from the context is slightly different. This is the code in the node-executive-v1.0 example object:")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" hello "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cxt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getExecutorByID")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node/simple/1.0/welcome"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("You can then call "),e("code",[t._v("hello.execute()")]),t._v(" to invoke the main function of the other knowledge object.")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("  results"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" hello"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("inputs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("In node you can pass javascript objects between KOs so there is no need to stringify your inputs as is needed for the V8 engine.")]),t._v(" "),e("h2",{attrs:{id:"python-engine-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#python-engine-example"}},[t._v("#")]),t._v(" Python engine example:")]),t._v(" "),e("p",[t._v("Python is similar to node in how you can call another KO. This is the code from the python-executive-v1.0 object:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" kgrid_python_runtime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Context\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("json_input"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  ctx "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_executor_by_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'python/simple/1.0/welcome'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("json_input"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("Note that the input is passed to the object in the same line that the executor is retrieved from the context.")])])}),[],!1,null,null,null);e.default=n.exports}}]);